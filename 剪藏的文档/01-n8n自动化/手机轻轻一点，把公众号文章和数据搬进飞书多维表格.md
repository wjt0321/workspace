---

title: 手机轻轻一点，把公众号文章和数据搬进飞书多维表格
date: 2025-10-23
tags: ["飞书", "n8n", "工作流自动化"]
category: 办公协作
---


# 手机轻轻一点，把公众号文章和数据搬进飞书多维表格

Original 鲤鱼冲啊 [鲤鱼冲啊](javascript:void(0);)*2025年10月23日 14:56* *福建*

刷公众号时，看到有用的文章，就随手点了收藏，结果越积越多，却一次都没回头看过。那些本该帮你提升，给你启发的内容，最终永久地遗忘在收藏夹里！想对文章数据进行分析，看哪些内容更容易获得流量，但是各个数据分析平台价格小贵。

这几天，我在尝试尽可能低成本的实现给出文章链接，就能自动把内容和数据写入多维表格。在了解了各种api以及分别尝试使用扣子，飞书多维表格，n8n工作流来实现功能，最终用n8n工作流实现了目标，目前获取1篇文章内容1分钱，数据1分钱，合计只要2分钱！

先说说我对扣子，飞书多维表格以及n8n工作流的使用感受：扣子里面有个插件“链接读取”，可以免费获取公众号文章标题和内容，这挺棒，但工作流完成后需要发布成智能体才能用，智能体必须带上大模型（导致浪费token，但我这个工作流是用不到大模型的）；飞书多维表格也能创建工作流，但没看到别人描述的AI生成工作流功能，webhook功能是收费的，没有看到代码节点，想处理数据的时候不知道怎么操作；n8n则搭建起来流畅很多（可能因为相对熟悉些），想要什么数据直接组合，最后再统一转换格式就好。

接下来看看效果：

手机快捷提交文章链接（会触发n8n的webhook节点）

![Image](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyb3zlrLMXIBFyWxYHaKT39iaJBtT5Ej4GOaA5IK9L5nDEvesDGibSv9zw/640?wx_fmt=png&from=appmsg#imgIndex=0)

手机会收到自定义反馈数据（由n8n的Respond to Webhook返回）

![Image 1](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyk5iaSRvZMicHbw54kwH3wZboehkWwnsMbUuWuFnicBLBICRRGaXnUxpBg/640?wx_fmt=png&from=appmsg#imgIndex=1)

飞书多维表格自动写入内容和数据（我这里字段没截全，具体以n8n工作流写入为准）

![Image 2](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyO18yCXOvALwDIO7yudUhicSTqE3s1SFWBamCkQgibRs3E9Zyg4l8asWQ/640?wx_fmt=png&from=appmsg#imgIndex=2)

![Image 3](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyLgVnNgokOhy8P3mSyeibBIqic9aPJ6IWZG18dyWib6aKP22skiaTqIXRfA/640?wx_fmt=png&from=appmsg#imgIndex=3)

来看看怎么操作（因篇幅有限，本篇主要介绍思路，不会写太详细）：

①手机需要一个可以快捷发送http请求的工具或app

我这里用的是安卓手机，Google Play应用商店下载安装HTTP Request Shortcuts

![Image 4](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyc3oUcyBpwWd8xsCJYjoTTyaXTZ8H1jdoqUhGADmaV8piasFcPFWVZNQ/640?wx_fmt=png&from=appmsg#imgIndex=4)

点击加号，选择从头创建

![Image 5](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyJeyUqaDonMf3eQ3hJicEZWF8fVWvpBdJiabZoZqBqUhia4uKTQEnnGGWw/640?wx_fmt=png&from=appmsg#imgIndex=5)

参考下图填写快捷方式名称，需要发送的请求（POST，链接具体在n8n的webhook节点设置）

![Image 6](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichydv6yq8uDJibnDpMsiahibWNXGfLIvZyTDCFdGwRM5BVHiatXuicTY8mE1DQ/640?wx_fmt=png&from=appmsg#imgIndex=6)

请求参数这边参考下图设置（就是要把微信文章分享链接传进去）

![Image 7](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichylibaep0dz4J48C0NjzTicoUTBnvia1PUpNSa9k9jKyZSKQjPpUE6cWWVg/640?wx_fmt=png&from=appmsg#imgIndex=7)

认证这边可以要正式运行的时候再设置（防止链接被其他人知道后乱提交数据），可以就用简单验证，输入自定义用户名和密码（自定义的用户名和密码在n8n的webhook节点设置）

![Image 8](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyMHy8RvtRkJEpzCKiaDY8hPucwdibEsF5DOohfFlNEa1lH08CAaIfmgJw/640?wx_fmt=png&from=appmsg#imgIndex=8)

配置好后打开app就会出现对应快捷方式，点开就可以发送链接，可以测试链接和正式链接各配置一个。

![Image 9](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVicsVD7TbksBxE8efXsuo1xNP71Rngicg0rOHO7wcKg5cenGKN3icBs1Hw/640?wx_fmt=png&from=appmsg#imgIndex=9)

②n8n工作流整体功能介绍

这是初步优化过的工作流，两个http节点分别获取文章内容和数据，加入了判断，第一个http节点如果接收到不合规链接就会终止工作流（通过if节点，其实可以直接在webhook节点后面就终止，但我为了使用Respond to Webhook来返回数据，所以改在http节点后终止），如果提取到了文章就会返回消息给手机端。

![Image 10](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyAEgyGcJ98icKzdRjVPOf4pXeYiboVv57uZzMeucrozH9xu8EZibw0QDnw/640?wx_fmt=png&from=appmsg#imgIndex=10)

接下来看看具体功能模块，

A模块，获取文章内容

通过webhook节点监听手机端提交的http请求，获取到的文章链接传递给第一个http节点，获取文章内容，对webhook节点不了解的可以看这篇[n8n的“超级智能门铃”，Webhook节点详解](https://mp.weixin.qq.com/s?__biz=Mzg5ODU1NjQ3MA==&mid=2247485729&idx=1&sn=a2579ba925c6aff45bfd3712a26e32de&scene=21#wechat_redirect)

![Image 11](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichy5p7c97XpMRVc39qmHng8xPlEvcUE3EErBlaxpGAJ3ryAMnsOlzIIgg/640?wx_fmt=png&from=appmsg#imgIndex=11)

webhook设置参考如下，在工作流里面点执行用的是测试链接，

![Image 12](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyrGiaRH5ajLZG1TSHRMPop0IAN2V6HlibNmudiavNpX06du60f9iaZMiaiarQ/640?wx_fmt=png&from=appmsg#imgIndex=12)

右上角这个开关打开后，工作流就激活了，使用的就是正式链接

![Image 13](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyibvItEvaDWclBFRuHxNVJfG4vWYiaDwNibkzlLVXjXic5MZo8XeCPS19sQ/640?wx_fmt=png&from=appmsg#imgIndex=13)

通过http节点获取文章内容的api文档看这篇，https://www.showdoc.com.cn/2343746579263506/11558501783383049，返回的数据还是蛮多的，包含发布时间，封面图链接，标题，摘要（小绿书的内容显示在摘要），去除html标签的内容和包含html标签的内容等，对于http节点使用不熟的可以看这篇[n8n的“万能钥匙”！HTTP Request节点，让你连接全世界！](https://mp.weixin.qq.com/s?__biz=Mzg5ODU1NjQ3MA==&mid=2247485644&idx=1&sn=0089dce342e7c816d314b82587c2fafa&scene=21#wechat_redirect)

http节点设置参考如下

![Image 14](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyhZuomic8pswg83FqL33JbFvMSuR8T1cTeicMNH2QafurBLos0husAZsg/640?wx_fmt=png&from=appmsg#imgIndex=14)

![Image 15](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichy0bAvfQ1QSKWMeZaZoJ83oZNrEibGuslGOhs9G27wNFant4c17arn6Zw/640?wx_fmt=png&from=appmsg#imgIndex=15)

秘钥通过后台获取（https://data.wxrank.com），

![Image 16](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVofq9vrtfJQZY4aE6deE5hBRmJXMVgKOu1tZ8txdwS8GHDWAibicDI7dQ/640?wx_fmt=png&from=appmsg#imgIndex=16)

B模块，获取文章数据

![Image 17](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichyB4Be4SLKnWMqHmoVyxMHNpkoV6iaXSVtwZltXqhJ8lL9RFGZHbGeMicA/640?wx_fmt=png&from=appmsg#imgIndex=17)

对应的api文档看这篇，https://www.showdoc.com.cn/2343746579263506/11133589262825168，可以看到，这里需要传入长链接（通过第一个http可获取到），想获取留言数的话需要先拿到留言id（也是通过第一个http获取）

![Image 18](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawV83NtGzNRHLNEjoUs8Z30wlU41qx5qicb53C2yt065oJib1CuUKoK3o9A/640?wx_fmt=png&from=appmsg#imgIndex=18)

先用set节点（也就是Edit Fields）将需要的字段取出，第二个app需要用到的是文章长链接，留言id，我这里还取出文章短链接和msg剩余积分（后面写入飞书文档），文章标题和code状态判断码（待传递到手机端）

![Image 19](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVuPLChr0ULFReOYrwtRo9hhUP8nOF4NhS4s6WrFGkjWblzOU5Licqk2w/640?wx_fmt=png&from=appmsg#imgIndex=19)

状态判断详见api文档，可以看到当code等于0时，文章获取成功

![Image 20](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVszoic9U4H4FXtiafKEP1clslIsdUDj3QHKBSP7iaBwKz8x3J5bCBCnP3g/640?wx_fmt=png&from=appmsg#imgIndex=20)

接下来的If节点做了判断，当code等于0时，将参数传递给后面的http节点，当code不等于0时，停止工作流

![Image 21](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVNKIllhaGuoibULmsaNM04VkolgSmPsBYbfLIABIB29EqUhwPK2Jz8ibA/640?wx_fmt=png&from=appmsg#imgIndex=21)

接下来用http节点获取数据，前面的参数和第一个http相同，body这边改为传入key，长链接和留言id

![Image 22](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawV0quq6xN0ianR994xjkg1dV54ASTW7IF0zOMqGZ1OYiapOI2SnzEBMNKA/640?wx_fmt=png&from=appmsg#imgIndex=22)

C模块，合并数据，筛选数据，清洗数据并写入飞书多维表格

这里将所有可能会用到的数据合并起来，使用set节点（Edit Fields）筛选出需要写入飞书多维表格的数据，最后写入多维表格。

![Image 23](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichy78feEibYjaNmV61dib1wC37qnE8d7d587joCiabF2kiciaW4ic0aBpjemuPQ/640?wx_fmt=png&from=appmsg#imgIndex=23)

Merge节点可以将不同输入源的数据合并起来（这里注意数据合并顺序，如果不同的数据源出现相同字段名，后面的会覆盖前面的）

![Image 24](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawViaUZnJXWE7WmLTQKlnRUFX8lZa8WDshYWVJgutBz8KicB2iaFdQslculA/640?wx_fmt=png&from=appmsg#imgIndex=24)

接下来筛选需要写入飞书的字段（字段太多，我这里只截取一小部分）

![Image 25](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVNVUKHKYicUcewNvnm13GGvTLPM1OJIhPywaRlgeKg8BB7kWKiaaRj9Jw/640?wx_fmt=png&from=appmsg#imgIndex=25)

这里就体现n8n的便利性了，先激活工作流，传入链接，可以看到数据，然后将对应字段直接拖动给节点就可以，简单直接

![Image 26](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVElQtm0uOibx1hLK3WZfyV4ibDJVtoibjYCA3PzSz5Uf7p1NAaIhlVOwHg/640?wx_fmt=png&from=appmsg#imgIndex=26)

在右侧可以看到待写入多维表格的内容

![Image 27](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawV7UfJnv04KqCT5ibJrWkrLplBTzOyMA5ggaibMxWr01icNBp2paKDXFOYA/640?wx_fmt=png&from=appmsg#imgIndex=27)

最后就是写入飞书多维表格了，这里用到了社区节点n8n-nodes-feishu-lite，使用方法可以看这篇[让AI帮你打工！n8n将AI资讯自动写入到你的飞书表格](https://mp.weixin.qq.com/s?__biz=Mzg5ODU1NjQ3MA==&mid=2247485195&idx=1&sn=2ae9e47bdcb5c57401b080ef973f304c&scene=21#wechat_redirect)，配置好权限，填入多维表格token和id（多维表格记得提前建好，并配置好所需字段）

![Image 28](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawViaSbVmW53QlSX4xcbynzaXy3n6OlbxNPMUVtPYkeYJa3u9cbecCZofg/640?wx_fmt=png&from=appmsg#imgIndex=28)

这里最关键的是请求体json怎么写，一个是要符合多维表格的写入要求（需要定义fields，参考下图写法）

![Image 29](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVb1h7kS9t8Zx9PcQgtJ8Vz0MRFGvb2epch3Iib9ZchOfKKXmj33PrsXA/640?wx_fmt=png&from=appmsg#imgIndex=29)

我这里是先传入一个链接，获取到输入的json数据，复制到text文档，上传给gemini-2.5-pro，同时把上面这个格式要求截图上传，填写n8n字段名和多维表格字段名的对应关系（比如title对应标题），然后让gemini帮我写请求体json，先把工作流跑通，把数据写入多维表格（刚开始可能会遇到各种报错，截图给gemini分析，比如api获取到的点赞数是数字格式，而多维表格配置的是字符串格式，对应不上就会写不进去）

等到数据都能正常写入飞书后，会发现写入的数据可能会有乱码，需要清洗掉。仍然可以截图给gemini，让它给出调整方案

![Image 30](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVARdL379L3Xjht9RV6kLXyiaN8ARE0eP4DVSgjicmWGwQBiaZibsClqWQpA/640?wx_fmt=png&from=appmsg#imgIndex=30)

最终的请求体JSON就变成了这样

![Image 31](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawV8AwKFTlicv6uxViagOmnBFicvvoqib8MxAksNd3ag4r4ZcbHuT9wKTYtvQ/640?wx_fmt=png&from=appmsg#imgIndex=31)

最终写入效果如下

![Image 32](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawV7yRkReAqTEpFhNfCPOWujQmmM63YhUlRuuKffwibwmrwAdm5icsSe3oQ/640?wx_fmt=png&from=appmsg#imgIndex=32)

D模块，优化手机消息提醒

我这里希望webhook监听到链接后，不要马上返回消息给我（因为还不能确认是否获取到了文章内容），所以等真正获取到文章内容后，再接入Respond to Webhook，自定义我所需要的消息

![Image 33](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatOqGNYUszib4TibyTuhxHXichysmYhpgicv2ysPIkpRPdYre6db4ia4CcIVwDuLAbnVpXC9iaXFBPgeIrPQ/640?wx_fmt=png&from=appmsg#imgIndex=33)

参数比较简单，参考下图

![Image 34](https://mmbiz.qpic.cn/mmbiz_png/Y6SAzWmciatObLhrpDzeZba8lGsjexawVLbWVKgdFicIucDb0xXYQr9WnxnbzEVaCB6wibALgyZs3CTAz2SdqqcXA/640?wx_fmt=png&from=appmsg#imgIndex=34)

不过在实践中发现，如果长时间没使用这个工作流，第一次传入链接，可能会等待很久，实际写入成功或不成功，这是因为时间超限导致Respond to Webhook返回错误信息（还没找到可以在哪调整），第二次开始就正常了，目前还没找到解决办法（可以先传一个假数据，比如1，让工作流快速报错，然后再传入正确链接，后续就很快了）。

最后附上工作流文件（https://pan.quark.cn/s/2e81567940cb），需要自行修改里面的key和表格token等，如果飞书节点显示不正常，请安装社区节点n8n-nodes-feishu-lite

好了，今天的内容就到这里，感觉有帮助的话，点赞收藏关注起来，我们下期见！

