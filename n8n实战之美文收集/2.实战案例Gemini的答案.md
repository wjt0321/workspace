åŸºäºæ‚¨æä¾›çš„ã€Šç¾æ–‡æ”¶é›†æ ‡å‡†æµç¨‹.mdã€‹éå¸¸è¯¦å°½ä¸”é€»è¾‘ä¸¥å¯†ï¼Œè¦åœ¨ n8n ä¸Šéƒ¨ç½²è¿™ä¸ªè‡ªåŠ¨åŒ–å·¥ä½œæµï¼Œæˆ‘ä»¬éœ€è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼š**å¦‚ä½•è®©äº‘ç«¯çš„è‡ªåŠ¨åŒ–æµç¨‹ä¸æ‚¨æœ¬åœ°çš„ Obsidian çŸ¥è¯†åº“è¿›è¡Œäº¤äº’**ã€‚

æœ€æ¨èçš„æ–¹æ¡ˆæ˜¯åˆ©ç”¨ **Git (GitHub/GitLab)** ä½œä¸ºä¸­è½¬ç«™ï¼Œæˆ–è€…ä½¿ç”¨æ”¯æŒ **S3 åè®®**çš„å­˜å‚¨ï¼ˆå¦‚æ‚¨ä¹‹å‰æåˆ°çš„ Cloudflare R2ï¼‰ã€‚

ä»¥ä¸‹æ˜¯åŸºäº n8n çš„è‡ªåŠ¨åŒ–éƒ¨ç½²æ¶æ„æ–¹æ¡ˆï¼š

### 1. æ ¸å¿ƒæ¶æ„è®¾è®¡

- **è§¦å‘å™¨**ï¼šSchedule Triggerï¼ˆæ¯å¤©å®šæ—¶è§¦å‘ï¼‰ã€‚
    
- **å¤§è„‘ (LLM)**ï¼šOpenAI (GPT-4o) æˆ– Anthropic (Claude 3.5 Sonnet) â€”â€” _Claude 3.5 åœ¨ä»£ç å’Œæ ¼å¼æ’ç‰ˆä¸Šæ›´ä¼˜ï¼Œé€‚åˆå¤„ç† Markdown æ¨¡ç‰ˆã€‚_
    
- **çœ¼ç› (Search)**ï¼šSerpApi æˆ– Google Custom Search API â€”â€” _ç”¨äºæ‰§è¡Œ Step 3 çš„åŸæ–‡æœç´¢å’Œç‰ˆæœ¬éªŒè¯ã€‚_
    
- **æ‰‹ (Storage)**ï¼šGitHub API èŠ‚ç‚¹ â€”â€” _ç”¨äºè¯»å–æ¨¡ç‰ˆã€å†™å…¥æ–‡ç« ã€æ›´æ–°ç´¢å¼•æ–‡ä»¶ã€‚_
    

---

### 2. n8n å·¥ä½œæµè¯¦ç»†æ‹†è§£

å»ºè®®å°†å·¥ä½œæµè®¾è®¡ä¸º **â€œä¸»æµç¨‹ + å­æµç¨‹â€** çš„æ¨¡å¼ï¼Œä»¥ä¿æŒé€»è¾‘æ¸…æ™°ã€‚

#### ğŸŸ¢ é˜¶æ®µä¸€ï¼šåˆå§‹åŒ–ä¸çŠ¶æ€è¯»å– (Step 0 & 5)

åœ¨å¼€å§‹æ”¶é›†å‰ï¼Œå¿…é¡»å…ˆè¯»å–å½“å‰çš„ç´¢å¼•çŠ¶æ€ï¼Œé˜²æ­¢é‡å¤ã€‚

1. **Schedule Trigger**: è®¾ç½®ä¸ºæ¯å¤©å‡Œæ™¨è¿è¡Œã€‚
    
2. **GitHub Node (Get File)**: è¯»å– `ç¾æ–‡æ€»ç´¢å¼•.md` å’Œ `{çº§åˆ«}ç¾æ–‡/ç¾æ–‡æ”¶é›†ç´¢å¼•.md`ã€‚
    
3. **LLM Node (Decision)**:
    
    - è¾“å…¥ï¼šæ€»ç´¢å¼•å†…å®¹ã€‚
        
    - æç¤ºè¯ï¼šâ€œé˜…è¯»å½“å‰æ€»ç´¢å¼•ï¼Œåˆ¤æ–­â€˜å°å­¦ç”Ÿç¾æ–‡â€™ï¼ˆæˆ–å…¶ä»–çº§åˆ«ï¼‰ç›®å‰çš„æ”¶å½•æ•°é‡ã€‚å¦‚æœä»Šæ—¥éœ€è¦æ”¶é›†ï¼Œè¯·è§„åˆ’ 1-2 ä¸ªå°šæœªæ”¶å½•çš„ç»å…¸æ•£æ–‡é¢˜ç›®å’Œä½œè€…ã€‚â€
        
    - _æ­¤å¤„å·²éšå«æ‰§è¡Œäº† Step 5 çš„æ€»ç´¢å¼•é¢„æ£€ã€‚_
        

#### ğŸ”µ é˜¶æ®µäºŒï¼šåŸæ–‡çŒå–ä¸éªŒè¯ (Step 1 & 3)

è¿™æ˜¯æœ€è€—è´¹ token å’Œéœ€è¦è”ç½‘çš„æ­¥éª¤ã€‚

1. **Split In Batches**: å¯¹è§„åˆ’å¥½çš„é¢˜ç›®è¿›è¡Œå¾ªç¯å¤„ç†ã€‚
    
2. **AI Agent Node (LangChain)**:
    
    - **Tools**: æŒ‚è½½ SerpApi å·¥å…·ã€‚
        
    - **System Prompt**: ä½¿ç”¨æˆ‘ä¸ºæ‚¨æ‹†è§£çš„ **â€œåŸæ–‡çŒæ‰‹æ™ºèƒ½ä½“ (Full-text Hunter)â€** æç¤ºè¯ã€‚
        
    - **æ ¸å¿ƒæŒ‡ä»¤**ï¼šâ€œæœç´¢ã€Š{ä½œå“å}ã€‹çš„å®Œæ•´ç‰ˆã€‚**å¿…é¡»æ‰§è¡Œä¸‰æ­¥éªŒè¯æ³•**ï¼šæœç´¢â€˜è¯¾æ–‡ä¸åŸæ–‡åŒºåˆ«â€™ã€‚å¦‚æœç¡®è®¤æ˜¯å®Œæ•´ç‰ˆï¼Œè¿”å›çº¯æ–‡æœ¬å†…å®¹ï¼›å¦‚æœç½‘ä¸Šåªæœ‰åˆ å‡ç‰ˆï¼Œè¿”å›å¤±è´¥ã€‚â€
        

#### ğŸŸ£ é˜¶æ®µä¸‰ï¼šæ ¼å¼åŒ–ä¸æ¨¡ç‰ˆåº”ç”¨ (Step 4 & 7)

å°†çº¯æ–‡æœ¬è½¬åŒ–ä¸ºç¬¦åˆæ‚¨ä¸¥æ ¼æ ‡å‡†çš„ Obsidian æ–‡æ¡£ã€‚

1. **GitHub Node (Get File)**: è¯»å–å¯¹åº”çš„æ¨¡ç‰ˆæ–‡ä»¶ï¼ˆå¦‚ `å°å­¦ç”Ÿç¾æ–‡/ç¾æ–‡èµæä¸æ•™å­¦é€šç”¨æ¨¡ç‰ˆ.md`ï¼‰ã€‚
    
2. **LLM Node (Formatter)**:
    
    - è¾“å…¥ï¼šåŸæ–‡å†…å®¹ + æ¨¡ç‰ˆå†…å®¹ã€‚
        
    - **System Prompt**: ä½¿ç”¨ **â€œæ–‡ç« æ’ç‰ˆå·¥ç¨‹å¸ˆ (Article Formatter)â€** æç¤ºè¯ã€‚
        
    - **æ ¸å¿ƒæŒ‡ä»¤**ï¼šâ€œå°†åŸæ–‡å¡«å…¥æ¨¡ç‰ˆï¼Œä¸¥æ ¼æ‰§è¡Œ Emoji å¯†åº¦è¦æ±‚ï¼ˆæ¯ 2-3 å¥ä¸€ä¸ªï¼‰ï¼Œè¡¥å…¨ YAML å…ƒæ•°æ®ã€‚ç¡®ä¿è¾“å‡º 100% ç¬¦åˆæ¨¡ç‰ˆç»“æ„ã€‚â€
        
    - _æ­¤å¤„åŒæ—¶è®© LLM æ‰§è¡Œ Step 7 çš„è´¨é‡è‡ªæ£€ã€‚_
        

#### ğŸŸ  é˜¶æ®µå››ï¼šæ–‡ä»¶å†™å…¥ä¸é“¾æ¥ (Step 6)

ç”Ÿæˆæ–‡ä»¶å¹¶æ¨é€åˆ°ä»“åº“ã€‚

1. **GitHub Node (Create/Update File)**:
    
    - è·¯å¾„ï¼š`d/workspace/{çº§åˆ«}ç¾æ–‡/{åºå·}.{ä½œå“å}-{ä½œè€…}.md` (æ³¨æ„ Git è·¯å¾„è½¬æ¢)ã€‚
        
    - å†…å®¹ï¼šLLM è¾“å‡ºçš„ Markdown å†…å®¹ã€‚
        
    - Commit Message: `feat: è‡ªåŠ¨æ”¶å½•ã€Š{ä½œå“å}ã€‹`ã€‚
        
2. **LLM Node (Snippet Gen)**: ç”Ÿæˆ Step 1 è¦æ±‚çš„å¸¦ Emoji çš„ç‰‡æ®µã€‚
    
3. **GitHub Node (Update File)**: å°†ç‰‡æ®µè¿½åŠ åˆ° `{çº§åˆ«}ç¾æ–‡ç²¾é€‰100ç¯‡.md`ï¼Œå¹¶æ·»åŠ  `[[å®Œæ•´æ–‡ç« æ–‡ä»¶å]]` é“¾æ¥ã€‚
    

#### ğŸ”´ é˜¶æ®µäº”ï¼šæ€»ç´¢å¼•æ›´æ–° (Step 8 - é“å¾‹)

è¿™æ˜¯æ‚¨æµç¨‹ä¸­å¼ºè°ƒçš„**ä¸å¯è¿èƒŒçš„é“å¾‹**ã€‚

1. **Merge Data**: æ±‡æ€»ä¸Šè¿°æ­¥éª¤ä¸­æ‰€æœ‰æˆåŠŸæ”¶å½•çš„æ–‡ç« ä¿¡æ¯ã€‚
    
2. **GitHub Node (Get File)**: å†æ¬¡è¯»å–æœ€æ–°çš„ `ç¾æ–‡æ€»ç´¢å¼•.md` (é˜²æ­¢å¹¶å‘å†²çª)ã€‚
    
3. **LLM Node (Index Updater)**:
    
    - **System Prompt**: ä½¿ç”¨ **â€œæ€»ç´¢å¼•å®ˆæŠ¤è€… (Master Index Updater)â€** æç¤ºè¯ã€‚
        
    - **ä»»åŠ¡**ï¼šâ€œæ ¹æ®ä»Šæ—¥æ–°å¢çš„ N ç¯‡æ–‡ç« ï¼Œæ›´æ–°ç»Ÿè®¡æ•°æ®ã€åˆ†åº“æ¦‚å†µã€æœ€æ–°æ”¶å½•åˆ—è¡¨ã€‚è¿”å›æ›´æ–°åçš„ Markdown å…¨æ–‡ã€‚â€
        
4. **GitHub Node (Update File)**: å°†æ›´æ–°åçš„æ€»ç´¢å¼•æ¨é€åˆ° GitHubã€‚
    

---

### 3. å…³é”®é…ç½®å»ºè®® (é’ˆå¯¹æ‚¨çš„ç‰¹æ®Šéœ€æ±‚)

#### A. å…³äºâ€œä¸‰æ­¥éªŒè¯æ³•â€çš„å®ç°

åœ¨ n8n çš„ AI Agent Node ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡ **Thinking Process** æ¥å¼ºåˆ¶æ‰§è¡ŒéªŒè¯ã€‚

- **è®¾ç½®**ï¼šåœ¨ Agent çš„ Prompt ä¸­åŠ å…¥ï¼šâ€œCheck 1: Search keyword. Check 2: Search 'diff between textbook and original'. Check 3: Verify word count. ONLY proceed if all pass.â€
    
- **Loop**ï¼šå¦‚æœéªŒè¯å¤±è´¥ï¼ˆå‘ç°åªæœ‰åˆ å‡ç‰ˆï¼‰ï¼Œé…ç½® n8n çš„ `If` èŠ‚ç‚¹å›æ»šï¼Œé‡æ–°è®© LLM é€‰ä¸€ä¸ªæ–°çš„é¢˜ç›®ï¼Œæˆ–è€…ç›´æ¥è·³è¿‡ï¼Œå¹¶åœ¨é€šçŸ¥ä¸­æŠ¥é”™ã€‚
    

#### B. å…³äº Emoji çš„å¯†åº¦æ§åˆ¶

ä¸€èˆ¬çš„ LLM å¾ˆéš¾ç²¾å‡†æ§åˆ¶â€œæ¯2-3å¥è¯ä¸€ä¸ª Emojiâ€ã€‚

- **æŠ€å·§**ï¼šåœ¨ n8n çš„ LLM Node æ¸©åº¦ï¼ˆTemperatureï¼‰è®¾ç½®ä¸­ï¼Œç¨å¾®è°ƒé«˜åˆ° **0.7**ï¼Œå¹¶åœ¨ Prompt ä¸­ç»™å‡ºå…·ä½“çš„ Emoji ç¤ºä¾‹ï¼ˆFew-Shot Promptingï¼‰ï¼ŒæŠŠæ‚¨æ–‡æ¡£ä¸­çš„ä¾‹å­å–‚ç»™å®ƒï¼Œæ•ˆæœä¼šå¥½å¾ˆå¤šã€‚
    

#### C. æœ¬åœ°åŒæ­¥

æ‚¨éœ€è¦åœ¨æœ¬åœ°ç”µè„‘ä¸Šå®‰è£… **Obsidian Git æ’ä»¶**ã€‚

- æµç¨‹ï¼šn8n æ¯å¤©è‡ªåŠ¨æäº¤ commit åˆ° GitHub -> æ‚¨æ‰“å¼€ Obsidian -> æ’ä»¶è‡ªåŠ¨ Pull æ‹‰å–æ›´æ–°ã€‚
    
- è¿™æ ·æ—¢æ»¡è¶³äº†è‡ªåŠ¨åŒ–ï¼Œåˆä¿è¯äº†æ•°æ®åœ¨æœ¬åœ°çš„å®‰å…¨å’Œ Obsidian çš„åŒé“¾åŠŸèƒ½å¯ç”¨ã€‚
    

### 4. æ¨èçš„ n8n èŠ‚ç‚¹ç»„åˆ

å¦‚æœæ‚¨æƒ³å¿«é€Ÿå¼€å§‹ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ‹–æ‹½èŠ‚ç‚¹ï¼š

1. `Schedule` (Trigger)
    
2. `GitHub` (Download Master Index)
    
3. `OpenAI Chat Model` (Select Topic)
    
4. Loop Over Items (For each topic)
    
    5. AI Agent (SerpApi + LangChain: Find & Verify Text)
    
    6. GitHub (Download Template)
    
    7. OpenAI Chat Model (Format Content & Add Emojis)
    
    8. GitHub (Create Article.md)
    
    9. GitHub (Update Snippet.md)
    
5. `Code` (Aggregator: Summary of today's work)
    
6. `OpenAI Chat Model` (Update Master Index Content)
    
7. `GitHub` (Update Master Index.md)
    
8. `Telegram/Email` (Send Report: "Step 8 Complete")
    
